<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hyundai.project.dao.ClubMemberDAO">
 <!-- 
 /* 
 * 작성자 : 김승환
 * [회원가입, 이메일 조회, 전체 회원 조회, 회원정보 수정, 회원 탈퇴] 쿼리
 */
  -->
	<insert id="insertClubMember">
		insert into club_member
		(mno,email,from_social,name,password)
		values(sq_member.nextval, #{email},#{from_social},#{name},#{password})
	</insert>
	 
	<insert id="insertClubRoleSet" >
		insert into club_member_role_set
		(mno,club_member_email,role_set)
		values(sq_member_role.nextval, #{club_member_email},#{role_set})
	</insert>
	 
	 <select id="findByEmail" resultType="com.hyundai.project.dto.ClubMember2">
		select
		email, c1.moddate, regdate, c1.from_social, name, password,c2.role_set
		from
		club_member c1 join club_member_role_set c2
		on c1.email = c2.club_member_email
		where c1.email = #{email} and c1.from_social=#{social}
	 </select>
	
	 <select id="findAll" resultType="com.hyundai.project.dto.ClubMember">
		select * from club_member
	 </select>
	
	<update id="updateInfo">
		update club_member set email = #{email}, password = #{password} where email = #{now}
	</update>
	
	<update id="updateRoleEmail">
		update club_member_role_set set club_member_email = #{club_member_email} where club_member_email = #{now}
	</update>
	
	<update id="deleteRoleSet">
		delete from club_member_role_set where club_member_email = #{email}
	</update>
	
	<update id ="deleteInfo">
		delete from club_member where email = #{email}
	</update>

 
</mapper>
