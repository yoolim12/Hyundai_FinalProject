<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
<!-- Required meta tags -->
<meta charset="utf-8">
<!-- <meta name="viewport" content="width=device-width, initial-scale=1"> -->
 <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1">
<link rel="stylesheet" type="text/css"
   href="/resources/_ui/desktop/common/css/mobile.css">

<link rel="stylesheet" type="text/css" href="/resources/_ui/desktop/common/css/jquery-ui.min.css" media="all" />  
<link href="https://cdnjs.cloudflare.com/ajax/libs/video.js/7.14.3/video-js.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/video.js/7.14.3/video.min.js"></script>
    <script src="https://player.live-video.net/1.10.0/amazon-ivs-videojs-tech.min.js"></script>
<script type="text/javascript" src="/resources/_ui/desktop/common/js/jquery-1.11.2.min.js"></script>

<!-- Bootstrap CSS -->
<link
   href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
   rel="stylesheet"
   integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
   crossorigin="anonymous">
   
   
<!-- Global site tag (gtag.js) - Google Analytics -->
   <script async src="https://www.googletagmanager.com/gtag/js?id=G-D99PM3RKWZ"></script>
   <script>
  
   
     window.dataLayer = window.dataLayer || [];
     function gtag(){dataLayer.push(arguments);}
     gtag('js', new Date());
   
     gtag('config', 'G-D99PM3RKWZ');
   </script>
   
   <script>
   function GA_Event(action, label, category){
       alert("test");
       gtag('event', action, {
              'event_label': label,
              'event_category': category,
          });
    }
   </script>
</head>
<body>
    <div class="head">
        <div class="logo"></div>
        <h3 class="cnts_title ou1804" style="text-align: center;">
            <span class="title">
                H-DAY STREAMING
            </span>
        </h3>
    </div>
   <div id="main">
      <!-- ìŠ¤íŠ¸ë¦¬ë° -->
      <div id="streaming">
           <video id="amazon-ivs-videojs" class="video-js vjs-4-3 vjs-big-play-centered" controls autoplay playsinline></video>
       </div>

      <!-- ì±„íŒ…ë°© -->
      <div id="chating">
            <div id="msgArea" class="col">
            
            </div>
            <div class="col-11">
               <div class="input-group mb-3" id="fixInput">
                  <input type="text"
                     id="msg" class="form-control" aria-label="Recipient's username"
                     aria-describedby="button-addon2"
                     onkeyup="if(window.event.keyCode==13){send()}" />
                  <button class="btn btn-outline-secondary" type="button"
                     id="button-send" onclick="send(); ">ì „ì†¡</button>
               </div>
            </div>
      </div>
   </div>
   <div class="bottom">
    <div class="txt">
            <p class="tit">aweSOME life 7.<br>HANESOME-E</p>
            <p class="s_t">ë³€í•¨ì—†ëŠ” ì§€êµ¬ë¥¼ ê·¸ë¦¬ë©°<br>GKMCCì™€ í•¨ê»˜í•œ ì§€ì† ê°€ëŠ¥í•œ ì„ íƒ</p>      
        </div>
        <div class="profile">
            <img class="profileimg" src="/resources/_ui/desktop/common/images/ìœ ë¦¼.jpeg" />
            <p class="profilename">ë”í•œì„¬ë‹·ì»´</p>
        </div>

        <!-- <style>
            body {
                margin: 0;
            }
            .video-container {
                width: 640px;
                height: 480px;
                margin: 15px;
            }
        </style> -->
        
        <script
        src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>
        
    <script>
            (function play() {
                // Get playback URL from Amazon IVS API
                var PLAYBACK_URL = 'const DEFAULT_STREAM = "https://65cd6d00bb9f.ap-northeast-2.playback.live-video.net/api/video/v1/ap-northeast-2.293546108023.channel.lt4D0GzSMPEs.m3u8";';
                
                // Register Amazon IVS as playback technology for Video.js
                registerIVSTech(videojs);

                // Initialize player
                var player = videojs('amazon-ivs-videojs', {
                techOrder: ["AmazonIVS"]
                }, () => {
                console.log('Player is ready to use!');
                // Play stream
                player.src(PLAYBACK_URL);
                });
            })();
        </script>
    
    <script>
            const username = "[[${member.getMemail()}]]";
            const websocket = new WebSocket("ws://localhost:80/ws/chat");

            websocket.onmessage = onMessage;
            websocket.onopen = onOpen;
            websocket.onclose = onClose;

            function send() {
                if ($("#msg").val() == "") return;
                console.log("SEND");
                let msg = document.getElementById("msg");

                console.log(username + ":" + msg.value);
                websocket.send(username + ":" + msg.value);
                msg.value = "";
            }

            //ì±„íŒ…ì°½ì— ë“¤ì–´ì™”ì„ ë•Œ
            function onOpen(evt) {
                var str = username + ": ë‹˜ì´ ì…ì¥í•˜ì…¨ìŠµë‹ˆë‹¤.";
                websocket.send(str);
            }

            //ì±„íŒ…ì°½ì—ì„œ ë‚˜ê°”ì„ ë•Œ
            function onClose(evt) {
                var str = username + ": ë‹˜ì´ ë°©ì„ ë‚˜ê°€ì…¨ìŠµë‹ˆë‹¤.";
                websocket.send(str);
            }

            function onMessage(msg) {
                //console.log(msg);
                var data = msg.data;
                var sessionId = null;
                //ë°ì´í„°ë¥¼ ë³´ë‚¸ ì‚¬ëŒ
                var message = null;
                var arr = data.split(":");

                for (var i = 0; i < arr.length; i++) {
                    console.log("arr[" + i + "]: " + arr[i]);
                }

                var cur_session = username;

                //í˜„ì¬ ì„¸ì…˜ì— ë¡œê·¸ì¸ í•œ ì‚¬ëŒ
                console.log("cur_session : " + cur_session);

                sessionId = arr[0];
                message = arr[1];
                console.log("sessionID : " + sessionId);
                console.log("cur_session : " + cur_session);
            if (arr[1] == " ë‹˜ì´ ì…ì¥í•˜ì…¨ìŠµë‹ˆë‹¤." || arr[1] == " ë‹˜ì´ ë°©ì„ ë‚˜ê°€ì…¨ìŠµë‹ˆë‹¤.") {
                var str = "<div class='col-11'>";
                str += "<li class='alert alert-secondary' id='welcome'>";
                str += "<b>" + sessionId + message + "</b>";
                str += "</li</div>";
                $("#msgArea").append(str);
            } else {
                //ë¡œê·¸ì¸ í•œ í´ë¼ì´ì–¸íŠ¸ì™€ íƒ€ í´ë¼ì´ì–¸íŠ¸ë¥¼ ë¶„ë¥˜í•˜ê¸° ìœ„í•¨
                if (sessionId == cur_session) {
                    var str = "<div class='col-11'>";
                    str += "<li class='alert alert-secondary' id='chatUI'>";
                    str += "<span><span style='color: #574a95;'>" + sessionId + "</span> : " + message + "</span>";
                    str += "</li></div>";
                        $("#msgArea").append(str);
                    } else {
                        var str = "<div class='col-11'>";
                        str += "<li class='alert alert-warning' id='tachatUI'>";
                        str += "<span><span style='color: #574a95;'>" + sessionId + "</span> : " + message + "</span>";
                        str += "</li></div>";
                        $("#msgArea").append(str);
                    }
                }
            $('#msgArea').scrollTop($('#msgArea').height()*10);
            }

        </script>
        <div class="description">
            * ë³¸ ì˜ìƒì€ ê³µì‹ ê³„ì•½ì„ ë§ºì€ ë’¤ í˜‘ì˜í•˜ì— ì œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.<br>
            * ì˜ìƒì˜ 2ì°¨ ê°€ê³µì„ ê¸ˆí•©ë‹ˆë‹¤<br>
            <br>
            #ìœ ë¯¸ì˜ì„¸í¬ë“¤ #ìœ ë¯¸ì˜ì„¸í¬ë“¤ì‹œì¦Œ2 #í‹°ë¹™<br>
            <br>
            #ìœ ë¯¸2 #ìœ ë¯¸1 #ìœ ë¯¸ì˜ì„¸í¬ë“¤ëª°ì•„ë³´ê¸° #ìœ ë¯¸ì˜ì„¸í¬ë“¤ìš”ì•½<br>
            #ìœ ë¯¸ì˜ì„¸í¬ë“¤2ìš”ì•½  #ë°•ì§„ì˜ #ê¹€ê³ ì€<br>
            <br>
            ì œì‘ë„ì›€ : í‹°ë¹™ TVING
            <br>
            ğŸ¬ì±•í„°ì•ˆë‚´<br>
            5í™” 0:00<br>
            6í™” 10:40<br>
            <br>
            ì‚¬ìš©ëœ BGM<br>
            -  ì‚¬ì›” - ê·¸ëŒ€ì™€ í•¨ê»˜ ì¶¤ì„.mp3<br>
            <br>
            â–¶ ìì·¨ë°©ë‚¨ì í›„ì›í•˜ê¸° : http://twip.kr/imalone1234<br>
            â–¶ ìì·¨ë°©ë‚¨ìì˜ ë¬´ë¹„ì½”ë©˜íŠ¸ : https://url.kr/yuadCG<br>
            â–¶ ë¬¸ì˜ ì£¼ì†Œ : honzanam2017@naver.com<br>
            <br>
            â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“<br>
            [Video Source Support]<br>
            Youtube channel "freeticon" : https://www.youtube.com/c/Freeticon<br>
            â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“
        </div>
        <div class="watchagain" style="display: block !important;">
            <p> ë‹¤ì‹œë³´ê¸° </p>
            <div class="again again1">ë‹¤ì‹œë³´ê¸°1</div>
            <div class="again again2">ë‹¤ì‹œë³´ê¸°2</div>
            <div class="again again3">ë‹¤ì‹œë³´ê¸°3</div>
            <div class="again again4">ë‹¤ì‹œë³´ê¸°4</div>
            <div class="again again5">ë‹¤ì‹œë³´ê¸°5</div>
            <div class="again again6">ë‹¤ì‹œë³´ê¸°6</div>
            <div class="again again7">ë‹¤ì‹œë³´ê¸°7</div>
            <div class="again again8">ë‹¤ì‹œë³´ê¸°8</div>
        </div>
        
        <style>
            body {
                margin: 0;
            }

            .video-container {
                width: 640px;
                height: 480px;
                margin: 15px;
            }
        </style>

    </div>
</body>
</html>