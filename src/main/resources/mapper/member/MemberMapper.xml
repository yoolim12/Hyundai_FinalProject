<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hyundai.project.memberDAO.MemberDAO">
	
	<select id="showAllMember"
		resultType="com.hyundai.project.dto.MemberDTO">
		select * from member
	</select>
	
	<select id="getMemberInfo"
		resultType="com.hyundai.project.dto.MemberDTO">
		select * from member where memail = #{email}
	</select>
	
	<select id="modifyMember" parameterType="com.hyundai.project.dto.AuthMemberDTO">
		update member set mpassword=#{mpassword}, mname = #{mname}, birth = #{birth}, telnum = #{telnum}, maddress = #{maddress} where memail = #{memail}
	</select>
	
	<update id="admodifyMember">
		update member set mname = #{mname}, birth = #{birth}, telnum = #{telnum}, maddress = #{maddress}, gno = #{gno}, moddate = sysdate where memail = #{memail}
	</update>
	
	<delete id="delMember">
		delete from member where memail = #{email}
	</delete>
	
	<update id = "updateGrade">
		update member set gno = #{gno} where memail = #{email}
	</update>
	
	<!-- 유림 -->
	<insert id="simpleRegister" parameterType="com.hyundai.project.dto.MemberDTO">
		insert into member
		(memail, mname, birth, telnum, maddress, mgender, mpassword, memail_info, moddate, regdate, from_social, gno, mpoint)
		values (#{memail}, #{mname}, #{birth}, #{telnum}
			   , #{maddress}, #{mgender}, #{mpassword}, #{memail_info}
			   , sysdate, sysdate, #{from_social}, #{gno}, #{mpoint})
	</insert>
	
	<insert id="registerRole" parameterType="com.hyundai.project.dto.MemberRoleDTO">
		insert into memberrole
		(memail,role_set) 
		values (#{memail}, 'USER')
	</insert>
	
	<select id="findByEmail" resultType="com.hyundai.project.dto.MemberJoinDTO">
		select
		c1.memail, c1.moddate, c1.regdate, c1.from_social, c1.mname, c1.mpassword, c2.role_set, c1.gno, c1.birth, c1.telnum, c1.maddress, c1.mpoint, c1.mgender, c1.memail_info
		from
		member c1 join memberrole c2
		on c1.memail = c2.memail
		where c1.memail = #{memail} and c1.from_social=#{from_social}
	</select>

	<!-- 정민 -->
	<update id="pointApply">
		update member set mpoint = mpoint - #{ousedpoint} where memail = #{memail}
	</update>

	<select id="getPoint" resultType="int">
		select mpoint from member where memail = #{memail}
	</select>
</mapper>